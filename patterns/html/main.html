<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–ª–∞–≤–Ω–∞—è</title>
    <link rel = 'stylesheet' href = 'patterns/css/style.css'>
</head>
<body class = 'distribute-by-page'>
    <div class = 'left'>
        <h1 class = 'logo'>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π<br>–ñ—É—Ä–Ω–∞–ª</h1>
        <div class = 'list-of'>
            <div class = 'navigate nav-se' id = 'main'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 19v-6.733a4 4 0 0 0-1.245-2.9L13.378 3.31a2 2 0 0 0-2.755 0L4.245 9.367A4 4 0 0 0 3 12.267V19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2Z"/></svg>
                <h1>–ì–ª–∞–≤–Ω–∞—è</h1>
            </div>
            <div class = 'navigate' id = 'journal'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2" d="M3 6h18M3 12h10M3 18h15"/></svg>
                <h1>–ñ—É—Ä–Ω–∞–ª—ã</h1>
            </div>
            <div class = 'navigate' id = 'students'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="m16.719 19.752l-.64-5.124A3 3 0 0 0 13.101 12h-2.204a3 3 0 0 0-2.976 2.628l-.641 5.124A2 2 0 0 0 9.266 22h5.468a2 2 0 0 0 1.985-2.248"/><circle cx="12" cy="5" r="3"/><circle cx="4" cy="9" r="2"/><circle cx="20" cy="9" r="2"/><path stroke-linecap="round" stroke-linejoin="round" d="M4 14h-.306a2 2 0 0 0-1.973 1.671l-.333 2A2 2 0 0 0 3.361 20H7m13-6h.306a2 2 0 0 1 1.973 1.671l.333 2A2 2 0 0 1 20.639 20H17"/></g></svg>
                <h1>–û–±—É—á–∞—é—â–∏–µ—Å—è</h1>
            </div>
            <div class = 'navigate' id = 'teachers'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="m16.719 19.752l-.64-5.124A3 3 0 0 0 13.101 12h-2.204a3 3 0 0 0-2.976 2.628l-.641 5.124A2 2 0 0 0 9.266 22h5.468a2 2 0 0 0 1.985-2.248"/><circle cx="12" cy="5" r="3"/><circle cx="4" cy="9" r="2"/><circle cx="20" cy="9" r="2"/><path stroke-linecap="round" stroke-linejoin="round" d="M4 14h-.306a2 2 0 0 0-1.973 1.671l-.333 2A2 2 0 0 0 3.361 20H7m13-6h.306a2 2 0 0 1 1.973 1.671l.333 2A2 2 0 0 1 20.639 20H17"/></g></svg>
                <h1>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</h1>
            </div>
            <div class = 'navigate' id = 'groups'>
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1"><path stroke-linecap="round" stroke-linejoin="round" d="m16.719 19.752l-.64-5.124A3 3 0 0 0 13.101 12h-2.204a3 3 0 0 0-2.976 2.628l-.641 5.124A2 2 0 0 0 9.266 22h5.468a2 2 0 0 0 1.985-2.248"/><circle cx="12" cy="5" r="3"/><circle cx="4" cy="9" r="2"/><circle cx="20" cy="9" r="2"/><path stroke-linecap="round" stroke-linejoin="round" d="M4 14h-.306a2 2 0 0 0-1.973 1.671l-.333 2A2 2 0 0 0 3.361 20H7m13-6h.306a2 2 0 0 1 1.973 1.671l.333 2A2 2 0 0 1 20.639 20H17"/></g></svg>
                <h1>–ì—Ä—É–ø–ø—ã</h1>
            </div>
        </div>
        <div class = 'user' id="UDM">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="7" r="5"/><path stroke-linecap="round" stroke-linejoin="round" d="M17 14h.352a3 3 0 0 1 2.976 2.628l.391 3.124A2 2 0 0 1 18.734 22H5.266a2 2 0 0 1-1.985-2.248l.39-3.124A3 3 0 0 1 6.649 14H7"/></g></svg>
            <div class = 'userdata'>
                <h1 id = 'userFull'></h1>
                <h3 id = 'username'></h3>
            </div>
        </div>
    </div>
    <div class = 'right_wrap'>
        <div class = 'header'>
            <h1 id = 'pos'>–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–ºüëã</h1>
            <h3 id = 'pos-desc'>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π –∂—É—Ä–Ω–∞–ª</h3>
        </div>
        <div class = 'scene' id = 'SCENE'></div>
    </div>
</body>
</html>
<script src = 'patterns/js/jquery.js'></script>
<script src = 'patterns/js/httpClient.js'></script>
<script src = 'patterns/js/func.js'></script>
<script>
    let pagesData = {
        main: {title: '–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–ºüëã', desc: '–ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –∂—É—Ä–Ω–∞–ª–∞'},
        journal: {title: '–ñ—É—Ä–Ω–∞–ª—ã', desc: '–ñ—É—Ä–Ω–∞–ª—ã –∫ –∫–æ—Ç–æ—Ä—ã–º —É –≤–∞—Å –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø'},
        journal_view: {title: '–ü–æ–¥–æ–∂–¥–∏—Ç–µ...', desc: '–ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞'},
        students: {title: '–£—á–∞—â–∏–µ—Å—è', desc: '–í—Å–µ —É—á–µ–Ω–∏–∫–∏ –≤ —É—á—Ä–µ–∂–¥–µ–Ω–∏–∏'},
        teachers: {title: '–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏', desc: '–í—Å–µ –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏ –≤ —É—á—Ä–µ–∂–¥–µ–Ω–∏–∏'},
        groups: {title: '–ì—Ä—É–ø–ø—ã/–ö–ª–∞—Å—Å—ã', desc: '–í—Å–µ –≥—Ä—É–ø–ø—ã –≤ —É—á—Ä–µ–∂–¥–µ–Ω–∏–∏'},
    }

    let huge_access_level = ['students', 'teachers', 'groups'];

    let SCENE = $$.getElementById('SCENE');

    if (localStorage.getItem('userData') == null){
        navTo('login');
    }

    $$.getElementById('main').onclick = () => {
        changePage('main');
    }

    $$.getElementById('UDM').onclick = () => {
        localStorage.removeItem('userData');

        navTo('remove-token');
    }

    $$.getElementById('journal').onclick = () => {
        changePage('journal');
    }

    let userData = JSON.parse(localStorage.getItem('userData'));

    $$.getElementById('userFull').textContent = (userData.name === undefined) ? userData.firstName : userData.name + ' ' + userData.fatherName;
    $$.getElementById('username').textContent = '@' + (userData.username === undefined) ? userData.login : userData.username;

    console.log(JSON.parse(localStorage.getItem('userData')));

    huge_access_level.forEach(e => {
        if (userData.access_level !== 4){
            document.getElementById(e).style.display = 'none';
        } else {
            $$.getElementById(e).onclick = () => {
                changePage(e);
            }
        }
    })

    let journalDetails = {day: 0, month: 0, year: 2024, id: 0};

    let journalStudents = [];
    let journalStudentsPointer = 0;

    function buildJournal(data, jid){
        changePage('journal_view', false);

        journalDetails.id = data[0].id;
        
        $$.getElementById('pos').textContent = '–ñ—É—Ä–Ω–∞–ª ' + data[0].name;
        document.title = data[0].name;
        $$.getElementById('pos-desc').textContent = '–ì—Ä—É–ø–ø–∞/–£—á–±–µ–Ω—ã–π –∫–ª–∞—Å—Å ' + data[0].groupName + ' ' + data[0].groupNum;

        let lefts = $$.createElement('div');
        lefts.classList.add('table-left');

        let h23 = $$.createElement('h2');
        h23.textContent = '–°—Ç—É–¥–µ–Ω—Ç—ã';
        h23.setAttribute('style', 'min-height: 25px;');
        
        lefts.appendChild(h23);

        let dx = $$.createElement('div');
        dx.classList.add('table-rg-datas');

        let marks = $$.createElement('div');
        marks.classList.add('table-right');
        
        let datas = [];
        let datasLast;
        let w = ['–í–°', '–ü–ù', '–í–¢', '–°–†', '–ß–¢', '–ü–¢', '–°–ë'];

        const date = new Date();
        let weekDays = selectWeek(new Date(1716779067000));
        let today = weekDays[0].getDate() + '.' + Number(Number(weekDays[0].getMonth())+Number(1));

        for(let i = 0;i < 6;i++){
            let h2x = $$.createElement('h3');
            h2x.textContent = ((Number(weekDays[i].getDate()+1) <= 31) ? Number(weekDays[i].getDate()+1) : 1) + '.' + (((Number(weekDays[i].getDate()+1) <= 31) ? Number(Number(weekDays[i].getMonth())+Number(1)) + ' ' + w[i] : Number(Number(weekDays[i].getMonth())+Number(2)) + ' ' + w[i]));

            if (today === weekDays[i].getDate() + '.' + Number(Number(weekDays[i].getMonth())+Number(1))) {
                h2x.classList.add('this-day');
            }

            let dateFull = Number(weekDays[i].getDate()+1) + '.' + Number(Number(weekDays[i].getMonth())+Number(1));

            datas.push([dateFull, toUnixTime(weekDays[i].getDate(), Number(Number(weekDays[i].getMonth())+Number(1)), journalDetails.year)]);

            dx.appendChild(h2x);

        }

        marks.appendChild(dx);

        data.students.forEach(st => {
            let studentMarksRow = $$.createElement('div');
            studentMarksRow.classList.add('table-marks');
            
            let h24 = $$.createElement('h2');
            h24.textContent = st.lastName + ' ' + st.firstName + ' ' + st.fatherName;

            journalStudents.push({'student': st.lastName + ' ' + st.firstName + ' ' + st.fatherName, 'marks': []});

            lefts.appendChild(h24);

            datas.forEach(i => {
                console.log(i);
                var h22 = $$.createElement('h3');
                h22.classList.add('mark-label');
                h22.textContent = '¬∑';
                h22.setAttribute('mark-data', JSON.stringify({
                    date: i[1],
                    student: st.id,
                    group: st.group,
                    mark_value: -1,
                    journal: jid,
                    teacher: userData.id
                }));

                data.marks.forEach(m => {
                    let markDay = i[1];
                    let markh = m.mark;

                    if (m.studentID === st.id && Number(m.date_create) === Number(markDay)) {
                        switch (markh) {
                            case '5':
                                h22.style.color = 'var(--green)';
                                h22.classList.add('green-mark');
                                h22.setAttribute('mark-data', JSON.stringify({
                                    date: markDay,
                                    student: st.id,
                                    group: st.group,
                                    mark_value: markh,
                                    journal: jid,
                                    teacher: userData.id
                                }));
                                h22.textContent = String(markh);

                                journalStudents[journalStudentsPointer].marks.push(Number(markh));
                                break;

                            case '4':
                                h22.style.color = 'var(--green)';
                                h22.classList.add('green-mark');
                                h22.setAttribute('mark-data', JSON.stringify({
                                    date: markDay,
                                    student: st.id,
                                    group: st.group,
                                    mark_value: markh,
                                    journal: jid,
                                    teacher: userData.id
                                }));
                                h22.textContent = String(markh);

                                journalStudents[journalStudentsPointer].marks.push(Number(markh));
                                break;

                            case '3':
                                h22.style.color = 'var(--yellow)';
                                h22.classList.add('yellow-mark');
                                h22.setAttribute('mark-data', JSON.stringify({
                                    date: markDay,
                                    student: st.id,
                                    group: st.group,
                                    mark_value: markh,
                                    journal: jid,
                                    teacher: userData.id
                                }));
                                h22.textContent = String(markh);

                                journalStudents[journalStudentsPointer].marks.push(Number(markh));
                                break;

                            case '2':
                                h22.style.color = 'var(--red)';
                                h22.classList.add('red-mark');
                                h22.setAttribute('mark-data', JSON.stringify({
                                    date: markDay,
                                    student: st.id,
                                    group: st.group,
                                    mark_value: markh,
                                    journal: jid,
                                    teacher: userData.id
                                }));
                                h22.textContent = String(markh);

                                journalStudents[journalStudentsPointer].marks.push(Number(markh));
                                break;

                            case 'none':
                                h22.style.color = 'var(--red)';
                                markh = '–ù–ë';
                                h22.classList.add('red-mark');
                                h22.setAttribute('mark-data', JSON.stringify({
                                    date: markDay,
                                    student: st.id,
                                    group: st.group,
                                    mark_value: markh,
                                    journal: jid,
                                    teacher: userData.id
                                }));
                                h22.textContent = String(markh);

                                journalStudents[journalStudentsPointer].marks.push(0);
                                break;

                            case 'late':
                                h22.style.color = 'var(--red)';
                                markh = '–û–ü';
                                h22.classList.add('red-mark');
                                h22.setAttribute('mark-data', JSON.stringify({
                                    date: markDay,
                                    student: st.id,
                                    group: st.group,
                                    mark_value: markh,
                                    journal: jid,
                                    teacher: userData.id
                                }));
                                h22.textContent = String(markh);

                                journalStudents[journalStudentsPointer].marks.push(-1);
                                break;

                            case 'bd':
                                h22.style.color = 'var(--yellow)';
                                markh = '–ü–ë';
                                h22.classList.add('red-mark');
                                h22.setAttribute('mark-data', JSON.stringify({
                                    date: markDay,
                                    student: st.id,
                                    group: st.group,
                                    mark_value: markh,
                                    journal: jid,
                                    teacher: userData.id
                                }));
                                h22.textContent = String(markh);

                                journalStudents[journalStudentsPointer].marks.push(-2);
                                break;

                            default:
                                //h22.textContent = '‚Äî';
                                //h22.classList.add('none-mark');
                                break;
                        }
                    }
                });

                studentMarksRow.appendChild(h22);

                if (userData.access_level !== 3) {
                    h22.onclick = () => {
                        h22.classList.add('focused-mark');
                        editMark(h22);
                    }
                }
            });

            journalStudentsPointer++;

            marks.appendChild(studentMarksRow);
        });

        let tableTop = $$.createElement('div');
        tableTop.classList.add('table');
        tableTop.appendChild(lefts);
        tableTop.appendChild(marks);

        console.log(datas);

        let dxm = document.createElement('div');
        dxm.classList.add('dxml');

        let stats = document.createElement('button');
        stats.textContent = '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞';
        stats.classList.add('btn');

        stats.addEventListener('click', () => {
            showModal('stats');
        });

        let statsx = document.createElement('button');
        statsx.textContent = '–ü—Ä–µ–¥—ã–¥—É—â–∏–µ –Ω–µ–¥–µ–ª–∏';
        statsx.classList.add('btn');

        let statsxs = document.createElement('button');
        statsxs.textContent = '–î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ';
        statsxs.classList.add('btn');

        dxm.appendChild(stats);
        dxm.appendChild(statsx);
        dxm.appendChild(statsxs);

        SCENE.appendChild(tableTop);
        SCENE.appendChild(dxm);

        console.log(data);
    }

    function showModal(type, data = null){
        let modal;

        var item;
        if (type === 'stats') {
            let head = document.createElement('h1');
            head.classList.add('modal-name');
            head.textContent = '–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –æ—Ç—á—ë—Ç—ã –ø–æ –∂—É—Ä–Ω–∞–ª—É';

            let students = document.createElement('div');
            students.classList.add('stud-list');

            let marks = [];

            journalStudents.forEach(item => {
                let avg = 0;

                let none = 0;
                let late = 0;
                let noneIll = 0;

                item.marks.forEach(m => {
                    avg += m;
                    marks.push(m);

                    if (m === 0){
                        none++;
                    } else if (m === -1){
                        late++;
                    } else if (m === -2){
                        noneIll++;
                    }
                })

                avg = Number(avg / item.marks.length).toPrecision(2);

                let tp = document.createElement('h4');
                tp.classList.add('modal-stud');
                tp.textContent = item.student;

                let tpx = document.createElement('h5');
                tpx.classList.add('modal-stud-val');
                tpx.textContent = '–°—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ: ' + avg + ' | –ü—Ä–æ–ø—É—Å–∫–æ–≤: ' + none + ' | –û–ø–∞–∑–¥–∞–Ω–∏–π: ' + late + ' | –ü—Ä–æ–ø—É—Å–∫–æ–≤ –ø–æ –±–æ–ª–µ–∑–Ω–∏: ' + noneIll;

                students.appendChild(tp);
                students.appendChild(tpx);
            });

            let statsVals = {"uspPerc": 0, "percQual": 0, "sou": 0};

            let __marks = {"5": 0, "4": 0, "3": 0, "2": 0};

            marks.forEach(el => {
                if (el === 5 || el === 4 || el === 3 || el === 2){
                    __marks[String(el)]++;
                }
            })

            statsVals.uspPerc = Number(((__marks["5"] + __marks["4"] + __marks["3"]) * 100) / journalStudents.length).toFixed(2);
            statsVals.percQual = Number(((__marks["5"] + __marks["4"]) * 100) / journalStudents.length).toFixed(2);
            statsVals.sou = Number((__marks["5"] * 100 + __marks["4"] * 64 + __marks["4"] + __marks["3"] * 36 + __marks["2"] * 16) / journalStudents.length).toFixed(2);

            console.log(statsVals)

            let addstats = document.createElement('div');
            addstats.textContent = '–ê–±—Å–æ–ª—é—Ç–Ω–∞—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å: ' + statsVals.uspPerc + '% | –ö–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–∞—è —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å: ' + statsVals.percQual + '% |  –°—Ç–µ–ø–µ–Ω—å –æ–±—É—á–µ–Ω–Ω–æ—Å—Ç–∏ —É—á–∞—â–∏—Ö—Å—è: ' + statsVals.sou + '%';
            addstats.classList.add('tsa');

            let dvs = document.createElement('div');
            dvs.classList.add('modal-win');
            dvs.appendChild(head);
            dvs.appendChild(students);
            dvs.appendChild(addstats);

            let cl = document.createElement('button');
            cl.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
            cl.classList.add('btn');
            cl.addEventListener('click', () => {

                destroyEl(document.getElementById('MODAL'));
            })

            dvs.appendChild(cl);

            modal = dvs;


        } else if (type === 'make-journal'){
            let head = document.createElement('h1');
            head.classList.add('modal-name');
            head.textContent = '–°–æ–∑–¥–∞—Ç—å –∂—É—Ä–Ω–∞–ª';

            let inx = document.createElement('div');
            inx.classList.add('mod-list');

            let title = document.createElement('input');
            title.type = 'text';
            title.placeholder = '–ù–∞–∑–≤–∞–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞';
            title.id = 'journal_name';

            let titlex = document.createElement('input');
            titlex.type = 'text';
            titlex.placeholder = '–û–ø–∏—Å–∞–Ω–∏–µ –∂—É—Ä–Ω–∞–ª–∞';
            titlex.id = 'journal_desc';

            let gr = document.createElement('div');
            gr.textContent = '–ì—Ä—É–ø–ø–∞';
            gr.classList.add('groups-list');

            let __groupSelected = 0;

            getGroups(function (grl) {
               grl.forEach(e => {
                   let gd = document.createElement('h4');
                   gd.textContent = e.groupName + ' ' + e.groupNum;
                   gd.classList.add('gdk');

                   gd.addEventListener('click', () => {
                       document.querySelectorAll('.gdks').forEach(e => e.classList.remove('gdks'));

                       gd.classList.add('gdks');

                       __groupSelected = e.id;
                   })

                   gr.appendChild(gd);
               })
            });

            inx.appendChild(title);
            inx.appendChild(titlex);
            inx.appendChild(gr);

            let dvs = document.createElement('div');
            dvs.classList.add('modal-win');
            dvs.appendChild(head);
            dvs.appendChild(inx);

            let clx = document.createElement('button');
            clx.textContent = '–°–æ–∑–¥–∞—Ç—å';
            clx.classList.add('btn');
            clx.style.marginRight = '15px';
            clx.classList.add('btn-primary');
            clx.addEventListener('click', () => {
                makeJournal({
                    "title": title.value,
                    "desc": titlex.value,
                    "grid": __groupSelected,
                    "user": userData.id
                }, function (res){
                    if (res) {
                        changePage('journal');
                    } else {
                        showToast('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∂—É—Ä–Ω–∞–ª');
                    }

                    destroyEl(document.getElementById('MODAL'));
                })
            })

            let cl = document.createElement('button');
            cl.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
            cl.classList.add('btn');
            cl.addEventListener('click', () => {

                destroyEl(document.getElementById('MODAL'));
            })

            dvs.appendChild(clx);
            dvs.appendChild(cl);

            modal = dvs;
        } else if (type === 'edit-student'){
            let head = document.createElement('h1');
            head.classList.add('modal-name');
            head.textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç–∞';

            let inx = document.createElement('div');
            inx.classList.add('mod-list');

            let title = document.createElement('input');
            title.type = 'text';
            title.placeholder = data.firstName;

            let titlex = document.createElement('input');
            titlex.type = 'text';
            titlex.placeholder = data.lastName;

            let titlexa = document.createElement('input');
            titlexa.type = 'text';
            titlexa.placeholder = data.fatherName;

            let gr = document.createElement('div');
            gr.textContent = '–ì—Ä—É–ø–ø–∞';
            gr.classList.add('groups-list');

            let __groupSelected = 0;

            getGroups(function (grl) {
                grl.forEach(e => {
                    let gd = document.createElement('h4');
                    gd.textContent = e.groupName + ' ' + e.groupNum;
                    gd.classList.add('gdk');

                    if (grl.id === data.group) gd.classList.add('gdks');

                    gd.addEventListener('click', () => {
                        document.querySelectorAll('.gdks').forEach(e => e.classList.remove('gdks'));

                        gd.classList.add('gdks');

                        __groupSelected = e.id;
                    })

                    gr.appendChild(gd);
                })
            });

            inx.appendChild(title);
            inx.appendChild(titlex);
            inx.appendChild(titlexa);
            inx.appendChild(gr);

            let dvs = document.createElement('div');
            dvs.classList.add('modal-win');
            dvs.appendChild(head);
            dvs.appendChild(inx);

            let clx = document.createElement('button');
            clx.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
            clx.classList.add('btn');
            clx.style.marginRight = '15px';
            clx.classList.add('btn-primary');
            clx.addEventListener('click', () => {
                makeJournal({
                    "title": title.value,
                    "desc": titlex.value,
                    "grid": __groupSelected,
                    "user": userData.id
                }, function (res){
                    if (res) {
                        changePage('journal');
                    } else {
                        showToast('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å');
                    }

                    destroyEl(document.getElementById('MODAL'));
                })
            })

            let cl = document.createElement('button');
            cl.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
            cl.classList.add('btn');
            cl.addEventListener('click', () => {

                destroyEl(document.getElementById('MODAL'));
            })

            dvs.appendChild(clx);
            dvs.appendChild(cl);

            modal = dvs;
        } else if (type === 'add-student'){
            let head = document.createElement('h1');
            head.classList.add('modal-name');
            head.textContent = '–î–æ–±–∞–≤–∏—Ç—å –æ–±—É—á–∞—é—â–µ–≥–æ—Å—è';

            let inx = document.createElement('div');
            inx.classList.add('mod-list');

            let title = document.createElement('input');
            title.type = 'text';
            title.placeholder = '–ò–º—è';

            let titlex = document.createElement('input');
            titlex.type = 'text';
            titlex.placeholder = '–§–∞–º–∏–ª–∏—è';

            let titlexa = document.createElement('input');
            titlexa.type = 'text';
            titlexa.placeholder = '–û—Ç—á–µ—Å—Ç–≤–æ';

            let gr = document.createElement('div');
            gr.textContent = '–ì—Ä—É–ø–ø–∞';
            gr.classList.add('groups-list');

            let __groupSelected = 0;

            getGroups(function (grl) {
                grl.forEach(e => {
                    let gd = document.createElement('h4');
                    gd.textContent = e.groupName + ' ' + e.groupNum;
                    gd.classList.add('gdk');

                    gd.addEventListener('click', () => {
                        document.querySelectorAll('.gdks').forEach(e => e.classList.remove('gdks'));

                        gd.classList.add('gdks');

                        __groupSelected = e.id;
                    })

                    gr.appendChild(gd);
                })
            });

            inx.appendChild(title);
            inx.appendChild(titlex);
            inx.appendChild(titlexa);
            inx.appendChild(gr);

            let dvs = document.createElement('div');
            dvs.classList.add('modal-win');
            dvs.appendChild(head);
            dvs.appendChild(inx);

            let clx = document.createElement('button');
            clx.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
            clx.classList.add('btn');
            clx.style.marginRight = '15px';
            clx.classList.add('btn-primary');
            clx.addEventListener('click', () => {
                saveStudent({
                    "firstName": title.value,
                    "lastName": titlex.value,
                    "grid": __groupSelected,
                    "fatherName": titlexa.value
                }, function (res){
                    if (res) {
                        changePage('students');
                    } else {
                        showToast('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å');
                    }

                    destroyEl(document.getElementById('MODAL'));
                })
            })

            let cl = document.createElement('button');
            cl.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
            cl.classList.add('btn');
            cl.addEventListener('click', () => {

                destroyEl(document.getElementById('MODAL'));
            })

            dvs.appendChild(clx);
            dvs.appendChild(cl);

            modal = dvs;
        } else if (type === 'add-teacher'){
            let head = document.createElement('h1');
            head.classList.add('modal-name');
            head.textContent = '–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è';

            let inx = document.createElement('div');
            inx.classList.add('mod-list');

            let title = document.createElement('input');
            title.type = 'text';
            title.placeholder = '–ò–º—è';

            let titlex = document.createElement('input');
            titlex.type = 'text';
            titlex.placeholder = '–§–∞–º–∏–ª–∏—è';

            let titlexa = document.createElement('input');
            titlexa.type = 'text';
            titlexa.placeholder = '–û—Ç—á–µ—Å—Ç–≤–æ';

            inx.appendChild(title);
            inx.appendChild(titlex);
            inx.appendChild(titlexa);

            let dvs = document.createElement('div');
            dvs.classList.add('modal-win');
            dvs.appendChild(head);
            dvs.appendChild(inx);

            let clx = document.createElement('button');
            clx.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
            clx.classList.add('btn');
            clx.style.marginRight = '15px';
            clx.classList.add('btn-primary');
            clx.addEventListener('click', () => {
                saveTeacher({
                    "firstName": title.value,
                    "lastName": titlex.value,
                    "fatherName": titlexa.value
                }, function (res){
                    if (res) {
                        changePage('teachers');
                    } else {
                        showToast('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å');
                    }

                    destroyEl(document.getElementById('MODAL'));
                })
            })

            let cl = document.createElement('button');
            cl.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
            cl.classList.add('btn');
            cl.addEventListener('click', () => {

                destroyEl(document.getElementById('MODAL'));
            })

            dvs.appendChild(clx);
            dvs.appendChild(cl);

            modal = dvs;
        } else if (type === 'add-group'){
            let head = document.createElement('h1');
            head.classList.add('modal-name');
            head.textContent = '–î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É';

            let inx = document.createElement('div');
            inx.classList.add('mod-list');

            let title = document.createElement('input');
            title.type = 'text';
            title.placeholder = '–ù–∞–∑–≤–∞–Ω–∏–µ';

            let titlex = document.createElement('input');
            titlex.type = 'text';
            titlex.placeholder = '–ù–æ–º–µ—Ä';

            inx.appendChild(title);
            inx.appendChild(titlex);

            let dvs = document.createElement('div');
            dvs.classList.add('modal-win');
            dvs.appendChild(head);
            dvs.appendChild(inx);

            let clx = document.createElement('button');
            clx.textContent = '–°–æ—Ö—Ä–∞–Ω–∏—Ç—å';
            clx.classList.add('btn');
            clx.style.marginRight = '15px';
            clx.classList.add('btn-primary');
            clx.addEventListener('click', () => {
                saveGroup({
                    "name": title.value,
                    "number": titlex.value,
                }, function (res){
                    if (res) {
                        changePage('groups');
                    } else {
                        showToast('error', '–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å');
                    }

                    destroyEl(document.getElementById('MODAL'));
                })
            })

            let cl = document.createElement('button');
            cl.textContent = '–ó–∞–∫—Ä—ã—Ç—å';
            cl.classList.add('btn');
            cl.addEventListener('click', () => {

                destroyEl(document.getElementById('MODAL'));
            })

            dvs.appendChild(clx);
            dvs.appendChild(cl);

            modal = dvs;
        }

        let b = document.createElement('div');
        b.classList.add('modal-over');
        b.appendChild(modal);
        b.id = 'MODAL';

        document.body.appendChild(b);
    }

    function editMark(elx){
        let marksList = [
            {content: 5, style: 'color: white;background-color:var(--green);', desc: '–û—Ü–µ–Ω–∫–∞ ', val: 5},
            {content: 4, style: 'color: white;background-color:var(--green);', desc: '–û—Ü–µ–Ω–∫–∞ ', val: 4},
            {content: 3, style: 'color: white;background-color:var(--yellow);', desc: '–û—Ü–µ–Ω–∫–∞ ', val: 3},
            {content: 2, style: 'color: white;background-color:var(--red);', desc: '–û—Ü–µ–Ω–∫–∞ ', val: 2},
            {content: '', style: 'color: white;background-color:var(--red);', desc: '–ù–µ—Ç –Ω–∞ –ø–∞—Ä–µ', val: 'none'},
            {content: '', style: 'color: white;background-color:var(--red);', desc: '–û–ø–æ–∑–¥–∞–ª', val: 'late'},
            {content: '', style: 'color: white;background-color:var(--yellow);', desc: '–ù–µ—Ç –ø–æ –±–æ–ª–µ–∑–Ω–∏', val: 'bd'},
        ];

        let d = $$.createElement('div');
        d.classList.add('marks');

        marksList.forEach(el => {
            let v = $$.createElement('h3');
            v.textContent = el.desc + el.content;
            v.setAttribute('style', el.style);
            v.classList.add('marks-var');

            v.onclick = () => {
                oldvals = JSON.parse(elx.getAttribute('mark-data'));
                oldval = JSON.parse(elx.getAttribute('mark-data'));

                elx.textContent = el.desc + el.val;
                oldval.mark_value = el.val;

                elx.setAttribute('mark-data', JSON.stringify(oldval));

                if (oldvals.mark == null) {
                    console.log(oldval.date);
                    
                    setMark(oldval);
                } else {

                }
            }

            d.appendChild(v);
        });

        elx.onmouseleave = () => {
            destroyEl(d);
            elx.classList.remove('focused-mark');
        }

        elx.appendChild(d);
    }

    function selectWeek(date) {
        return Array(7).fill(new Date(date)).map((el, idx) =>
            new Date(el.setDate(el.getDate() - el.getDay() + idx)))
    }

    function setMark(data){
        doPost([
            ['act', 'set-mark'],
            ['userID', data.teacher],
            ['jouID', data.journal],
            ['grID', data.group],
            ['date', data.date],
            ['stID', data.student],
            ['markValue', data.mark_value]
        ], function (data){
            if (data.status == 200){

            } else {

            }

            console.log(data);
        });
    }

    function makeJournal(data, callback){
        doPost([
            ['act', 'add-journal'],
            ['title', data.title],
            ['desc', data.desc],
            ['grID', data.grid],
            ['user', data.user],
        ], function (data){
            if (data.status === 200){
                callback(true);
            } else {
                callback(false);
            }

            console.log(data);
        });
    }

    function saveStudent(data, callback){
        doPost([
            ['act', 'add-students-root'],
            ['firstname', data.firstName],
            ['lastname', data.lastName],
            ['fathername', data.fatherName],
            ['grid', data.grid],
        ], function (data){
            if (data.status === 200){
                callback(true);
            } else {
                callback(false);
            }

            console.log(data);
        });
    }

    function saveTeacher(data, callback){
        doPost([
            ['act', 'add-teachers-root'],
            ['firstname', data.firstName],
            ['lastname', data.lastName],
            ['fathername', data.fatherName],
        ], function (data){
            if (data.status === 200){
                callback(true);
            } else {
                callback(false);
            }

            console.log(data);
        });
    }

    function saveGroup(data, callback){
        doPost([
            ['act', 'add-group-root'],
            ['name', data.name],
            ['number', data.number],
        ], function (data){
            if (data.status === 200){
                callback(true);
            } else {
                callback(false);
            }

            console.log(data);
        });
    }

    function getGroups(callback){
        doPost([
            ['act', 'get-all-groups']
        ], function (data){
            if (data.status === 200){
                callback(data.content);
            }
            console.log(data);
        });
    }

    let __editUser;

    function buildStudents(data) {
        let EL = $$.createElement('div');
        EL.classList.add('list-of-journals');

        data.forEach(e => {
            let h1 = $$.createElement('h1');
            h1.textContent = e.lastName + ' ' + e.firstName + ' ' + e.fatherName;

            let h3 = $$.createElement('h3');
            h3.textContent = '–û—Ç–æ—Ä–±–∞–∂–∞–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –æ–±—É—á–∞—é—â–∏—Ö—Å—è';

            let wrap = $$.createElement('div');
            wrap.classList.add('journal-el');

            let gr = $$.createElement('h4');
            gr.classList.add('group-jo');
            gr.textContent = e.groupName + ' ' + e.groupNum;

            let comWrap = $$.createElement('div');
            comWrap.classList.add('jour-wrap-text');
            comWrap.appendChild(h1);
            comWrap.appendChild(h3);

            wrap.appendChild(gr);
            wrap.appendChild(comWrap);

            __editUser = e;

            wrap.insertAdjacentHTML('beforeend', `<svg onclick="editStudent()" class = "edit sv dx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"><path d="m16.475 5.408l2.117 2.117m-.756-3.982L12.109 9.27a2.118 2.118 0 0 0-.58 1.082L11 13l2.648-.53c.41-.082.786-.283 1.082-.579l5.727-5.727a1.853 1.853 0 1 0-2.621-2.621"/><path d="M19 15v3a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3"/></g></svg>`)
            wrap.insertAdjacentHTML('beforeend', '<svg class = "del dx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 6h16l-1.58 14.22A2 2 0 0 1 16.432 22H7.568a2 2 0 0 1-1.988-1.78zm3.345-2.853A2 2 0 0 1 9.154 2h5.692a2 2 0 0 1 1.81 1.147L18 6H6zM2 6h20m-12 5v5m4-5v5"/></svg>')

            EL.appendChild(wrap);
        });

        let stats = document.createElement('button');
        stats.textContent = '–î–æ–±–∞–≤–∏—Ç—å –æ–±—É—á–∞—é—â–µ–≥–æ—Å—è';
        stats.classList.add('btn');

        stats.addEventListener('click', () => {
            showModal('add-student');
        })

        SCENE.appendChild(EL);
        if (userData.access_level === 4) SCENE.appendChild(stats);
    }

    function buildGroups(data) {
        let EL = $$.createElement('div');
        EL.classList.add('list-of-journals');

        data.forEach(e => {
            let h1 = $$.createElement('h1');
            h1.textContent = e.groupName + ' ' + e.groupNum;

            let h3 = $$.createElement('h3');
            h3.textContent = '';

            let wrap = $$.createElement('div');
            wrap.classList.add('journal-el');

            let gr = $$.createElement('h4');
            gr.classList.add('group-jo');
            gr.textContent = e.groupName + ' ' + e.groupNum;

            let comWrap = $$.createElement('div');
            comWrap.classList.add('jour-wrap-text');
            comWrap.appendChild(h1);
            comWrap.appendChild(h3);

            wrap.appendChild(gr);
            wrap.appendChild(comWrap);

            __editUser = e;

            wrap.insertAdjacentHTML('beforeend', `<svg onclick="editStudent()" class = "edit sv dx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"><path d="m16.475 5.408l2.117 2.117m-.756-3.982L12.109 9.27a2.118 2.118 0 0 0-.58 1.082L11 13l2.648-.53c.41-.082.786-.283 1.082-.579l5.727-5.727a1.853 1.853 0 1 0-2.621-2.621"/><path d="M19 15v3a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3"/></g></svg>`)
            wrap.insertAdjacentHTML('beforeend', '<svg class = "del dx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 6h16l-1.58 14.22A2 2 0 0 1 16.432 22H7.568a2 2 0 0 1-1.988-1.78zm3.345-2.853A2 2 0 0 1 9.154 2h5.692a2 2 0 0 1 1.81 1.147L18 6H6zM2 6h20m-12 5v5m4-5v5"/></svg>')

            EL.appendChild(wrap);
        });

        let stats = document.createElement('button');
        stats.textContent = '–î–æ–±–∞–≤–∏—Ç—å –≥—Ä—É–ø–ø—É';
        stats.classList.add('btn');

        stats.addEventListener('click', () => {
            showModal('add-group');
        })

        SCENE.appendChild(EL);
        if (userData.access_level === 4) SCENE.appendChild(stats);
    }

    function buildTeachers(data) {
        let EL = $$.createElement('div');
        EL.classList.add('list-of-journals');

        data.forEach(e => {
            let h1 = $$.createElement('h1');
            h1.textContent = e.lastName + ' ' + e.name + ' ' + e.fatherName;

            let h3 = $$.createElement('h3');
            h3.textContent = '–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å';

            let wrap = $$.createElement('div');
            wrap.classList.add('journal-el');

            let comWrap = $$.createElement('div');
            comWrap.classList.add('jour-wrap-text');
            comWrap.appendChild(h1);
            comWrap.appendChild(h3);

            wrap.appendChild(comWrap);

            __editUser = e;

            wrap.insertAdjacentHTML('beforeend', `<svg onclick="editStudent()" class = "edit sv dx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1"><path d="m16.475 5.408l2.117 2.117m-.756-3.982L12.109 9.27a2.118 2.118 0 0 0-.58 1.082L11 13l2.648-.53c.41-.082.786-.283 1.082-.579l5.727-5.727a1.853 1.853 0 1 0-2.621-2.621"/><path d="M19 15v3a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3"/></g></svg>`)
            wrap.insertAdjacentHTML('beforeend', '<svg class = "del dx" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M4 6h16l-1.58 14.22A2 2 0 0 1 16.432 22H7.568a2 2 0 0 1-1.988-1.78zm3.345-2.853A2 2 0 0 1 9.154 2h5.692a2 2 0 0 1 1.81 1.147L18 6H6zM2 6h20m-12 5v5m4-5v5"/></svg>')

            EL.appendChild(wrap);
        });

        let stats = document.createElement('button');
        stats.textContent = '–î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è';
        stats.classList.add('btn');

        stats.addEventListener('click', () => {
            showModal('add-teacher');
        })

        SCENE.appendChild(EL);
        if (userData.access_level === 4) SCENE.appendChild(stats);
    }

    function editStudent(){
        showModal('edit-student', __editUser);
    }

    function buildJournals(data){
        let EL = $$.createElement('div');
        EL.classList.add('list-of-journals');

        data.forEach(e => {
            let h1 = $$.createElement('h1');
            h1.textContent = e.name;

            let h3 = $$.createElement('h3');
            h3.textContent = e.comment;

            let h4 = $$.createElement('h3');
            h4.textContent =  (e.date_last_edit !== null) ? '–ü–æ—Å–ª–µ–¥–Ω–µ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ: ' + timeFormat(e.date_last_edit, false) : '–ù–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π';

            let wrap = $$.createElement('div');
            wrap.classList.add('journal-el');

            let gr = $$.createElement('h4');
            gr.classList.add('group-jo');
            gr.textContent = e.groupName + ' ' + e.groupNum;

            let comWrap = $$.createElement('div');
            comWrap.classList.add('jour-wrap-text');
            comWrap.appendChild(h1);
            comWrap.appendChild(h3);
            comWrap.appendChild(h4);

            wrap.appendChild(gr);
            wrap.appendChild(comWrap);

            wrap.onclick = () => {
                doPost([
                    ['act', 'collect-journal-data'],
                    ['userID', userData.id],
                    ['jouID', e.id],
                    ['grID', e.groupID],
                ], function (data){
                    if (data.status === 200){
                        buildJournal(data.content, e.id);
                    } else {

                    }
                });
            }

            EL.appendChild(wrap);
        });

        let stats = document.createElement('button');
        stats.textContent = '–ù–æ–≤—ã–π –∂—É—Ä–Ω–∞–ª';
        stats.classList.add('btn');

        stats.addEventListener('click', () => {
            showModal('make-journal');
        })

        SCENE.appendChild(EL);
        SCENE.appendChild(stats);
    }
    
    let CURRENT_POS = 'main';

    function changePage(to, isLeft = true){
        SCENE.replaceChildren();

        history.pushState([], '', to);
        document.title = pagesData[to].title;

        switch (to) {
            case 'main':
                $$.querySelectorAll('.nav-se').forEach(e => {
                    e.classList.remove('nav-se');
                });
                $$.querySelectorAll('.list-of-journals').forEach(e => {
                    destroyEl(e);
                });

                if (isLeft) $$.getElementById(to).classList.add('nav-se');

                $$.getElementById('pos').textContent = pagesData[to].title;
                $$.getElementById('pos-desc').textContent = pagesData[to].desc;
            break;

            case 'journal_view':
                $$.querySelectorAll('.nav-se').forEach(e => {
                    e.classList.remove('nav-se');
                });
                $$.querySelectorAll('.list-of-journals').forEach(e => {
                    destroyEl(e);
                });
                
                if (isLeft) $$.getElementById(to).classList.add('nav-se');

                $$.getElementById('pos').textContent = pagesData[to].title;
                $$.getElementById('pos-desc').textContent = pagesData[to].desc;
            break;

            case 'students':
                if (userData.access_level !== 4) location.reload();

                $$.querySelectorAll('.nav-se').forEach(e => {
                    e.classList.remove('nav-se');
                });

                if (isLeft) $$.getElementById(to).classList.add('nav-se');

                $$.getElementById('pos').textContent = pagesData[to].title;
                $$.getElementById('pos-desc').textContent = pagesData[to].desc;

                doPost([
                    ['act', 'get-students-root'],
                ], function (data) {
                    if (data.status === 200) {
                        buildStudents(data.content);
                    } else {
                        showToast('error', data.content);
                    }
                });
            break;

            case 'groups':
                if (userData.access_level !== 4) location.reload();

                $$.querySelectorAll('.nav-se').forEach(e => {
                    e.classList.remove('nav-se');
                });

                if (isLeft) $$.getElementById(to).classList.add('nav-se');

                $$.getElementById('pos').textContent = pagesData[to].title;
                $$.getElementById('pos-desc').textContent = pagesData[to].desc;

                doPost([
                    ['act', 'get-groups-root'],
                ], function (data) {
                    if (data.status === 200) {
                        buildGroups(data.content);
                    } else {
                        showToast('error', data.content);
                    }
                });
                break;

            case 'teachers':
                if (userData.access_level !== 4) location.reload();

                $$.querySelectorAll('.nav-se').forEach(e => {
                    e.classList.remove('nav-se');
                });

                if (isLeft) $$.getElementById(to).classList.add('nav-se');

                $$.getElementById('pos').textContent = pagesData[to].title;
                $$.getElementById('pos-desc').textContent = pagesData[to].desc;

                doPost([
                    ['act', 'get-teachers-root'],
                ], function (data) {
                    if (data.status === 200) {
                        buildTeachers(data.content);
                    } else {
                        showToast('error', data.content);
                    }
                });
            break;

            case 'journal':
                $$.querySelectorAll('.nav-se').forEach(e => {
                    e.classList.remove('nav-se');
                });
                
                if (isLeft) $$.getElementById(to).classList.add('nav-se');
            
                $$.getElementById('pos').textContent = pagesData[to].title;
                $$.getElementById('pos-desc').textContent = pagesData[to].desc;

                if (userData.access_level === 4){
                    doPost([
                        ['act', 'get-journals-root'],
                        ['userID', userData.id],
                    ], function (data) {
                        if (data.status === 200) {
                            buildJournals(data.content);
                        } else {
                            showToast('error', data.content);
                        }
                    });
                } else if (userData.access_level === 3){
                    doPost([
                        ['act', 'get-journals-user'],
                        ['userID', userData.id],
                    ], function (data) {
                        if (data.status === 200) {
                            buildJournals(data.content);
                        } else {
                            showToast('error', data.content);
                        }
                    });
                } else {
                    doPost([
                        ['act', 'get-journals'],
                        ['userID', userData.id],
                    ], function (data) {
                        if (data.status === 200) {
                            buildJournals(data.content);
                        } else {
                            showToast('error', data.content);
                        }
                    });
                }
            break;
        
            default:
            break;
        }
    }
</script>